<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Nan Xiao &lt;nanx@uchicago.edu&gt; Gao Wang &lt;gaow@uchicago.edu&gt;" />

<meta name="date" content="2016-06-11" />

<title>Gene ID Mapping for Genotype-Tissue Expression (GTEx) Data</title>

<link href="data:text/css; charset=utf-8,%40font%2Dface%20%7B%0A%20%20font%2Dfamily%3A%20%27Merriweather%27%3B%0A%20%20font%2Dstyle%3A%20normal%3B%0A%20%20font%2Dweight%3A%20400%3B%0A%20%20src%3A%20local%28%27Merriweather%27%29%2C%20local%28%27Merriweather%2DRegular%27%29%2C%20url%28http%3A%2F%2Ffonts%2Egstatic%2Ecom%2Fs%2Fmerriweather%2Fv13%2FRFda8w1V0eDZheqfcyQ4EInF5uFdDttMLvmWuJdhhgs%2Ettf%29%20format%28%27truetype%27%29%3B%0A%7D%0A%40font%2Dface%20%7B%0A%20%20font%2Dfamily%3A%20%27Merriweather%27%3B%0A%20%20font%2Dstyle%3A%20normal%3B%0A%20%20font%2Dweight%3A%20700%3B%0A%20%20src%3A%20local%28%27Merriweather%20Bold%27%29%2C%20local%28%27Merriweather%2DBold%27%29%2C%20url%28http%3A%2F%2Ffonts%2Egstatic%2Ecom%2Fs%2Fmerriweather%2Fv13%2FZvcMqxEwPfh2qDWBPxn6nn06qf9KHRHwsVx7iw5MXmY%2Ettf%29%20format%28%27truetype%27%29%3B%0A%7D%0A" rel="stylesheet" type="text/css">


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20800px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20Merriweather%2C%20%22Palatino%20Linotype%22%2C%20%22Book%20Antiqua%22%2C%20Palatino%2C%20serif%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0Ah1%2Etitle%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Ah4%2Eauthor%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Ah4%2Edate%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%200px%3B%0Apadding%3A%2015px%3B%0Awidth%3A%20770px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E5%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2016px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2050px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2020px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%205px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%205px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Menlo%2C%20Monaco%2C%20%22Lucida%20Console%22%2C%20Consolas%2C%20%22Courier%20New%22%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%2025px%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20110%25%3B%0Afont%2Dweight%3A%20normal%3B%0A%7D%0Aem%20%7B%0Afont%2Dstyle%3A%20normal%3B%0A%7D%0Aemph%20%7B%0Afont%2Dstyle%3A%20oblique%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%23123d79%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%23007CC3%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23581858%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23007CC3%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%234271ae%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23c82829%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%23f5871f%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23718c00%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23718c00%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23718c00%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23718c00%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%238e908c%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%234d4d4c%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%234271ae%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20%7D%20%0A%0Aimg%20%7B%0Adisplay%3A%20block%3B%0Amargin%3A%200%20auto%3B%0A%7D%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Gene ID Mapping for Genotype-Tissue Expression (GTEx) Data</h1>
<h4 class="author"><em>Nan Xiao &lt;<a href="mailto:nanx@uchicago.edu">nanx@uchicago.edu</a>&gt;<br>Gao Wang &lt;<a href="mailto:gaow@uchicago.edu">gaow@uchicago.edu</a>&gt;</em></h4>
<h4 class="date"><em>2016-06-11</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#mapping-table"><span class="toc-section-number">2</span> Mapping Table</a></li>
<li><a href="#code-example"><span class="toc-section-number">3</span> Code Example</a></li>
<li><a href="#whats-next"><span class="toc-section-number">4</span> What’s Next?</a></li>
<li><a href="#acknowledgements"><span class="toc-section-number">5</span> Acknowledgements</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The Genotype-Tissue Expression (GTEx) project <span class="citation">(Lonsdale et al. 2013)</span> aims at measuring human tissue-specific gene expression levels. With the collected data, we will be able to explore the landscape of gene expression, gene regulation, and their deep connections with genetic variations.</p>
<p>Raw GTEx data contains expression measurements from various types of elements (such as genes, pseudogenes, noncoding DNA sequences) covering the whole genome. For some analysis, it might be desirable to only keep a subset of the data, for example, data from protein coding genes. In such cases, mapping the original Ensembl gene IDs to Entrez gene IDs or HGNC symbols become an essential step in the analysis pipeline.</p>
<p>The <code>grex</code> package offers a minimal dependency solution to do such ID mappings. Currently, an Ensembl ID from GTEx can be mapped to its Entrez gene ID, HGNC gene symbol, HGNC gene name, cytogenetic location, and UniProt ID. We also limit our scope on the Ensembl IDs appeared in the gene read count data. Ensembl IDs from transcript data will be considered in future versions.</p>
</div>
<div id="mapping-table" class="section level1">
<h1><span class="header-section-number">2</span> Mapping Table</h1>
<p>To facilitate such ID conversion tasks, the <code>grex</code> package has a built-in mapping table derived from the well-known annotation data package <code>org.Hs.eg.db</code> <span class="citation">(Carlson 2015)</span>. The mapping data we used has integrated mapping information from Ensembl and NCBI, to maximize the possibility of finding a matched Entrez ID. The R code for creating the table is located <a href="https://github.com/road2stat/grex/blob/master/data-raw/data-generator.R">here</a>.</p>
<p>Not surprisingly, when creating such a table, there were hundreds of cases where a single Ensembl ID can be mapped to multiple Entrez gene IDs. To create a one-to-one mapping, we took a simple approach: we just removed the duplicated Entrez IDs and only kept the first we encountered in the original database. Therefore, there might be cases where the mapping is not 100% accurate. If you have such doubts for particular results, please try searching the original ID on the Ensembl website and see if we got a correct mapped ID.</p>
</div>
<div id="code-example" class="section level1">
<h1><span class="header-section-number">3</span> Code Example</h1>
<p>As an example, we use the Ensembl IDs from GTEx V6 gene count data and select 100 IDs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;grex&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;gtexv6&quot;</span>)
id =<span class="st"> </span>gtexv6[<span class="dv">101</span>:<span class="dv">200</span>]
df =<span class="st"> </span><span class="kw">grex</span>(id)
<span class="kw">tail</span>(df)</code></pre></div>
<pre><code>##          ensembl_id entrez_id hgnc_symbol                                   hgnc_name
## 95  ENSG00000272153      &lt;NA&gt;        &lt;NA&gt;                                        &lt;NA&gt;
## 96  ENSG00000116198      9731      CEP104                  centrosomal protein 104kDa
## 97  ENSG00000169598      1677        DFFB       DNA fragmentation factor subunit beta
## 98  ENSG00000264428      &lt;NA&gt;        &lt;NA&gt;                                        &lt;NA&gt;
## 99  ENSG00000198912    339448    C1orf174         chromosome 1 open reading frame 174
## 100 ENSG00000236423 100133612   LINC01134 long intergenic non-protein coding RNA 1134
##     cyto_loc uniprot_id
## 95      &lt;NA&gt;       &lt;NA&gt;
## 96   1p36.32 A0A024R4G3
## 97    1p36.3     B4DZS0
## 98      &lt;NA&gt;       &lt;NA&gt;
## 99   1p36.32     Q8IYL3
## 100  1p36.32       &lt;NA&gt;</code></pre>
<p>The elements which cannot be mapped accurately will be <code>NA</code>.</p>
<p>Genes with a mapped Entrez ID:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">filtered_genes =<span class="st"> </span>df[!<span class="kw">is.na</span>(df$entrez_id), <span class="kw">c</span>(<span class="st">'ensembl_id'</span>, <span class="st">'entrez_id'</span>)]
<span class="kw">head</span>(filtered_genes)</code></pre></div>
<pre><code>##         ensembl_id entrez_id
## 1  ENSG00000175756     54998
## 3  ENSG00000221978     81669
## 4  ENSG00000224870    148413
## 5  ENSG00000242485     55052
## 8  ENSG00000235098    441869
## 10 ENSG00000205116    643965</code></pre>
<p>If you want to start from the raw GENCODE gene IDs provided by GTEx (e.g. <code>ENSG00000227232.4</code>), the function <code>cleanid()</code> can help you remove the <code>.version</code> part in them, to produce Ensembl IDs.</p>
</div>
<div id="whats-next" class="section level1">
<h1><span class="header-section-number">4</span> What’s Next?</h1>
<p>Usually, the next step is removing (or imputing) the genes with <code>NA</code> IDs, and then select the genes to keep. Notably, as was observed in the complete gene read count data, in about 100 cases, multiple Ensembl IDs can be mapped to one single Entrez ID. Post-processing steps may also be needed for such genes.</p>
</div>
<div id="acknowledgements" class="section level1">
<h1><span class="header-section-number">5</span> Acknowledgements</h1>
<p>We thank the members of <a href="http://stephenslab.uchicago.edu">Stephens lab</a> (Kushal K Dey, Lei Sun) for their valuable suggestions and helpful discussions on this problem.</p>
<hr>
<p>Project website: <a href="http://nanx.me/grex" class="uri">http://nanx.me/grex</a></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-hsdb">
<p>Carlson, Marc. 2015. <em>org.Hs.eg.db: Genome Wide Annotation for Human</em>.</p>
</div>
<div id="ref-gtex">
<p>Lonsdale, John, Jeffrey Thomas, Mike Salvatore, Rebecca Phillips, Edmund Lo, Saboor Shad, Richard Hasz, et al. 2013. “The Genotype-Tissue Expression (GTEx) Project.” <em>Nature Genetics</em> 45 (6): 580–85.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
